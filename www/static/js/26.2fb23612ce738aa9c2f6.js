webpackJsonp([26],{"1jdB":function(t,e){},aMeN:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("CPGk"),i={name:"HelloWorld",data:function(){return{active:!1,approval:!0,show:!1,data:{studentName:"",content:"",createTime:"",endTime:"",imageUrls:[],startTime:"",fuxiaozhang:"",jiaowuchu:"",leaveDay:"",xiaozhang:"",leaveInfo:[],teacherState:0},showBtn:!1,sendPerson:"家长、教务处、政务处",sendArr:[]}},filters:{fileTime:function(t){return s.a.dateFormat(t)}},methods:{returns:function(){this.$router.go(-1)},turnToMy:function(){this.$router.push({path:"/my"})},turnToIndex:function(){this.$router.push({path:"/indexs"})},agree:function(){this.show=!0},cancel:function(){var t=this,e=this,a={roleId:JSON.parse(localStorage.getItem("zhxy_user")).id,leaveId:this.$route.query.id,state:2,type:2};for(var s in this.data.teacherRole){if("班主任"==this.data.teacherRole[s]){a.type=1;break}for(var i in this.data.leaveInfo)this.data.leaveInfo[i].name==this.data.teacherRole[s]&&(a.roleId=this.data.teacherRole[i].id)}this.$http({url:this.$api.message.saveOrUpdateLeaveRole},a).then(function(a){console.log(a),0==a.code?t.$toast("审核成功"):t.$toast("审核失败"),t.getLeaveInfo(),t.show=!1,t.$router.push({path:"/leaveDetail",query:{active:!1,id:e.$route.query.id,type:1}})},function(e){t.$toast("出错了")})},confirm:function(){var t=this,e=this,a={roleId:JSON.parse(localStorage.getItem("zhxy_user")).id,leaveId:this.$route.query.id,state:1,type:1};for(var s in this.data.teacherRole){if("班主任"==this.data.teacherRole[s]){a.type=1;break}for(var i in this.data.leaveInfo)this.data.leaveInfo[i].name==this.data.teacherRole[s]&&(a.roleId=this.data.leaveInfo[i].id)}this.$http({url:this.$api.message.saveOrUpdateLeaveRole},a).then(function(a){console.log(a),0==a.code?t.$toast("审核成功"):t.$toast("审核失败"),t.getLeaveInfo(),t.show=!1,t.$router.push({path:"/leaveDetail",query:{active:!1,id:e.$route.query.id,type:1}})},function(e){t.$toast("出错了")})},insertLeaveRole:function(t,e){var a=this,s={leaveId:this.$route.query.id,roleId:t,state:4,type:1};s.type="校长"==e||"副校长"==e||"政教处"==e||"教务处"==e?2:3,this.$http({url:this.$api.message.insertLeaveRole},s).then(function(t){console.log(t),0==t.code&&a.getLeaveInfo()})},getLeaveInfo:function(){var t=this;this.$toast.loading({mask:!0,duration:0});var e=this;this.$http({url:this.$api.message.getLeaveInfo},{leaveId:this.$route.query.id,schoolId:JSON.parse(localStorage.getItem("zhxy_user")).schoolId,teacherId:JSON.parse(localStorage.getItem("zhxy_user")).id}).then(function(a){if(console.log(a),0==a.code){var s=a.data.leaveInfo,i=(a.data.leaveInfo.length,a.data.teacherRole),r=a.data.teacherRole.length;if(2==e.$route.query.type){for(var n=0;n<r;n++)if("班主任"==i[n]){t.showBtn=!0;break}for(var o in s)for(var n in i)s[o].name==i[n]&&s.splice(o,1)}else for(var o in s)5!=s[o].state&&2!=s[o].state&&t.sendArr.push(s[o].name);t.data=a.data,t.$toast.clear()}else t.$toast(a,msg)},function(e){t.$toast("出错了")})}},created:function(){this.active="1"==this.$route.query.type,this.getLeaveInfo()}},r={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"loginNav"},[s("img",{staticClass:"return",attrs:{src:a("Du5+"),alt:""},on:{click:t.returns}}),t._v(" "),s("p",{staticClass:"title f30 cfff text-center"},[t._v("请假审批")])]),t._v(" "),s("div",{staticClass:"content",style:{paddingTop:"0.84rem",paddingBottom:t.active?"1.7rem":"1rem"}},[s("table",{staticClass:"f28"},[s("tbody",[s("tr",[s("td",[t._v("申请人：")]),t._v(" "),s("td",[t._v(t._s(t.data.studentName))])]),t._v(" "),s("tr",[s("td",[t._v("申请时间：")]),t._v(" "),s("td",[t._v(t._s(t._f("fileTime")(t.data.createTime,t.data.createTime)))])]),t._v(" "),s("tr",[s("td",[t._v("请假时间：")]),t._v(" "),s("td",[t._v(t._s(t.data.startTime.replace(/-/g,".").substring(0,16))+"-"+t._s(t.data.endTime.replace(/-/g,".").substring(0,16)))])]),t._v(" "),s("tr",[s("td",[t._v("请假理由：")]),t._v(" "),s("td",[t._v(t._s(t.data.content))])])])]),t._v(" "),s("div",{staticClass:"pl-30 pr-30 pb-60 b_line"},t._l(t.data.imageUrls,function(e,a){return s("img",{key:a,staticClass:"mb-10",attrs:{src:t.$api.fileUrl+e,alt:""}})})),t._v(" "),t.showBtn?s("div",{staticClass:"sendOut f28 c333 b_line pl-30"},[s("span",[t._v("推送至")])]):s("div",{staticClass:"sendOut f24 c333 pl-30 pr-30"},[s("span",[t._v("推送至")]),t._v(" "),s("span",[t._v(t._s(t.sendArr.toString()))])]),t._v(" "),s("div",[s("ul",{staticClass:"f24 pl-30"},t._l(t.data.leaveInfo,function(e,a){return t.showBtn?s("li",{key:a,staticClass:"b_line pr-30"},[s("p",[t._v(t._s(e.name))]),t._v(" "),5==e.state?s("button",{staticClass:"bg_6b7",on:{click:function(a){t.insertLeaveRole(e.id,e.name)}}},[t._v("发送")]):1==e.state?s("p",{staticClass:"c999"},[t._v("已通过")]):2==e.state?s("p",{staticClass:"c999"},[t._v("未审核")]):3==e.state?s("p",{staticClass:"c999"},[t._v("已失效")]):4==e.state?s("p",{staticClass:"c999"},[t._v("待审核")]):t._e()]):t._e()}))])]),t._v(" "),t.active&&4==t.data.teacherState?s("div",{staticClass:"centerBtn f26 cfff text-center",on:{click:t.agree}},[t._v("审 核")]):!t.active||2!=t.data.teacherState&&3!=t.data.teacherState?s("div",{staticClass:"centerBtn f26 cfff text-center",on:{click:t.agree}},[t._v("待确认")]):s("div",{staticClass:"centerBtn f26 cfff text-center",on:{click:t.agree}},[t._v("已审核")]),t._v(" "),s("van-popup",{staticClass:"f30 c999",model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[s("div",{staticClass:"question"},[s("p",{staticClass:"c333"},[t._v("提示")]),t._v(" "),s("p",{staticClass:"f28 mt-70"},[t._v("是否同意请假信息？")])]),t._v(" "),s("div",{staticClass:"choose pt-30 pb-30"},[s("p",{on:{click:t.cancel}},[t._v("不同意")]),t._v(" "),s("p",{staticClass:"c333",on:{click:t.confirm}},[t._v("同意")])])])],1)},staticRenderFns:[]};var n=a("C7Lr")(i,r,!1,function(t){a("1jdB")},"data-v-c75530da",null);e.default=n.exports}});
//# sourceMappingURL=26.2fb23612ce738aa9c2f6.js.map