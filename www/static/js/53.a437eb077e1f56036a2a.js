webpackJsonp([53],{GHgd:function(t,e){},"sV/e":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});s("hUua");var o=s("5pFn"),a=s("CPGk"),i={data:function(){return{modelShow:!1,modelShow1:!1,columnClass:[],columns:[],nowClass:"选择班级",nowClassId:0,nowSbject:"选择科目",nowSbjectId:0,homeworkDetail:{title:"",workDesc:"",images:[],videos:[]},columnsData:[],columnClassData:[]}},filters:{fileTime:function(t){return a.a.dateFormat(t)}},methods:{returns:function(){this.$router.push({path:"/homework"})},deleteThis:function(t){this.homeworkDetail.images.replace(t,1)},deleteThisV:function(t){this.homeworkDetail.videos.replace(t,1)},onRead:function(t){var e=this;console.log(t);var s=new FormData;s.append("file",t.file),this.$fileHttp(this.$api.fileUpload,s).then(function(t){console.log(t),0==t.code&&e.homeworkDetail.images.push(t.data[0])})},onReadV:function(t){var e=this,s=new FormData;s.append("file",t.file),this.$fileHttp(this.$api.fileUpload,s).then(function(t){console.log(t),0==t.code&&e.homeworkDetail.videos.push(t.data[0])})},onConfirm:function(t,e){this.modelShow=!this.modelShow,this.nowClass=t[0],this.nowClassId=this.columnClassData[e].classes_id},onCancel:function(t,e,s){this.modelShow=!this.modelShow,t.setColumnValues(1,columns[values[0]])},onConfirm1:function(t,e){this.modelShow1=!this.modelShow1,this.nowSbject=t[0],this.nowSbjectId=this.columnsData[e].courses_id},onCancel1:function(t,e,s){this.modelShow1=!this.modelShow1},next:function(){this.submit()},getHomeworkDetail:function(){var t=this;this.$http({url:this.$api.homework.getHomeworkDetail},{homeworkId:this.$route.query.id}).then(function(e){if(console.log(e),0==e.code){for(var s in t.homeworkDetail=e.data,t.nowSbject=e.data.coursesName,t.nowClass=e.data.classesName,t.nowClassId=e.data.classesId,t.nowSbjectId=e.data.coursesId,t.columnsData)if(t.columnsData[s].courses_id==e.data.coursesId){t.columns[0].defaultIndex=Number(s);break}for(var s in t.columnClassData)if(t.columnClassData[s].classes_id==e.data.classesId){t.columnClass[0].defaultIndex=Number(s);break}}else t.$toast(e.msg)})},getSubject:function(){var t=this;this.nowSbject;this.$http({url:this.$api.homework.getSubject},{teacherId:JSON.parse(localStorage.getItem("zhxy_user")).id}).then(function(e){if(console.log(e),0==e.code){var s=[];for(var o in e.data)s.push(e.data[o].courses_name);var a=[{values:s}];t.columnsData=e.data,t.columns=a,t.$route.query.id?t.nowSbjectId=-1:(t.nowSbject=a[0].values[0],t.nowSbjectId=e.data[0].courses_id)}})},getClass:function(){var t=this;this.$http({url:this.$api.homework.getClass},{teacherId:JSON.parse(localStorage.getItem("zhxy_user")).id}).then(function(e){if(console.log(e),0==e.code){var s=[];for(var o in e.data)s.push(e.data[o].coursesName);var a=[{values:s}];t.columnClassData=e.data,t.columnClass=a,t.$route.query.id?t.nowClassId=-1:(t.nowClass=a[0].values[0],t.nowClassId=e.data[0].classes_id)}})},submit:function(){var t=this;if(""!=this.homeworkDetail.title)if(""!=this.homeworkDetail.workDesc)if(-1!=this.nowClassId&&0!=this.nowClassId)if(-1!=this.nowSbjectId&&0!=this.nowSbjectId){var e={classesId:this.nowClassId,teacherId:JSON.parse(localStorage.getItem("zhxy_user")).id,coursesId:this.nowSbjectId,title:this.homeworkDetail.title,workDesc:this.homeworkDetail.workDesc,imageUrl:this.homeworkDetail.images.toString(),videoUrl:this.homeworkDetail.videos.toString()};this.$route.query.id&&(e.id=this.$route.query.id),this.$http({url:this.$api.homework.setOrEditHomework},e).then(function(e){console.log(e),0==e.code?(t.$route.query.id?t.$toast("编辑成功"):t.$toast("发布成功"),t.$router.go(-1)):t.$toast(e.msg)})}else this.$toast("请选择科目");else this.$toast("请选择班级");else this.$toast("请输入作业内容");else this.$toast("请输入标题")},show:function(t){Object(o.a)([this.$api.fileUrl+t])}},created:function(){this.getSubject(),this.getClass(),this.$route.query.id&&this.getHomeworkDetail()}},l={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("div",{staticClass:"loginNavFix"},[o("img",{staticClass:"return",attrs:{src:s("Du5+"),alt:""},on:{click:t.returns}}),t._v(" "),o("p",{staticClass:"title f30 cfff text-center"},[t._v(t._s(t.$route.query.id?"编辑作业":"发布作业"))])]),t._v(" "),o("div",{staticClass:"setBox"},[o("div",{staticClass:"setTitle pl-30 f28 c333"},[t._v("\n            标题\n            "),o("input",{directives:[{name:"model",rawName:"v-model",value:t.homeworkDetail.title,expression:"homeworkDetail.title"}],staticClass:"oinp",attrs:{type:"text",placeholder:"请输入"},domProps:{value:t.homeworkDetail.title},on:{input:function(e){e.target.composing||t.$set(t.homeworkDetail,"title",e.target.value)}}})]),t._v(" "),o("div",{staticClass:"home-comntent"},[o("p",{staticClass:"pl-30 f28 c333 pt-20 pb-30"},[t._v("内容")]),t._v(" "),o("textarea",{directives:[{name:"model",rawName:"v-model",value:t.homeworkDetail.workDesc,expression:"homeworkDetail.workDesc"}],staticClass:"textarea f26 pl-30 pr-30 pt-10",attrs:{name:"",id:"",cols:"30",rows:"10",placeholder:"请输入帖子内容"},domProps:{value:t.homeworkDetail.workDesc},on:{input:function(e){e.target.composing||t.$set(t.homeworkDetail,"workDesc",e.target.value)}}})]),t._v(" "),o("div",{staticClass:"upload"},[o("p",{staticClass:"pl-30 f28 c333 pt-20 pb-30"},[t._v("图片")]),t._v(" "),o("div",{staticClass:"iploadBox"},[t._l(t.homeworkDetail.images,function(e,s){return o("div",{key:s,staticClass:"imgShowBox",on:{click:function(s){t.show(e)}}},[o("div",{staticClass:"imgShow"},[o("img",{attrs:{src:t.$api.fileUrl+e,alt:""}}),t._v(" "),o("span",{staticClass:"closeX f20",on:{click:function(e){t.deleteThis(s)}}},[t._v("X")])])])}),t._v(" "),t.homeworkDetail.images.length<10?o("div",{staticClass:"imgShowBox"},[o("van-uploader",{attrs:{"after-read":t.onRead,accept:"image/png, image/jpeg"}},[o("img",{staticClass:"imgShow",attrs:{src:s("cW4t"),alt:""}})])],1):t._e()],2)]),t._v(" "),o("div",{staticClass:"upload mt-30"},[o("p",{staticClass:"pl-30 f28 c333 pt-20 pb-30"},[t._v("视频")]),t._v(" "),o("div",{staticClass:"iploadBox"},[t._l(t.homeworkDetail.videos,function(e,s){return o("div",{key:s,staticClass:"imgShowBox"},[o("div",{staticClass:"imgShow"},[o("img",{attrs:{src:t.$api.fileUrl+e,alt:""}}),t._v(" "),o("span",{staticClass:"closeX f20",on:{click:function(e){t.deleteThisV(s)}}},[t._v("X")])])])}),t._v(" "),t.homeworkDetail.videos.length<1?o("div",{staticClass:"imgShowBox"},[o("van-uploader",{attrs:{"after-read":t.onReadV,accept:"video/*"}},[o("img",{staticClass:"imgShow",attrs:{src:s("cW4t"),alt:""}})])],1):t._e()],2)]),t._v(" "),o("div",{staticClass:"setTitle pl-30 f28 c333 mt-30 borderTop",on:{click:function(e){t.modelShow=!0}}},[t._v("\n            "+t._s(t.nowClass)+"\n            "),o("img",{attrs:{src:"",alt:""}}),t._v(" "),o("img",{staticClass:"msgTo",attrs:{src:s("PkOM"),alt:""}})]),t._v(" "),o("div",{staticClass:"setTitle pl-30 f28 c333",on:{click:function(e){t.modelShow1=!0}}},[t._v("\n            "+t._s(t.nowSbject)+"\n            "),o("img",{staticClass:"msgTo",attrs:{src:s("PkOM"),alt:""}})]),t._v(" "),o("div",{staticClass:"centerBtn f26 cfff text-center",on:{click:t.next}},[t._v("发布")])]),t._v(" "),o("van-popup",{attrs:{position:"bottom",overlay:!0},model:{value:t.modelShow,callback:function(e){t.modelShow=e},expression:"modelShow"}},[o("van-picker",{ref:"pikers",attrs:{"show-toolbar":"",columns:t.columnClass},on:{cancel:t.onCancel,confirm:t.onConfirm}})],1),t._v(" "),o("van-popup",{attrs:{position:"bottom",overlay:!0},model:{value:t.modelShow1,callback:function(e){t.modelShow1=e},expression:"modelShow1"}},[o("van-picker",{attrs:{"show-toolbar":"",columns:t.columns},on:{cancel:t.onCancel1,confirm:t.onConfirm1}})],1)],1)},staticRenderFns:[]};var n=s("C7Lr")(i,l,!1,function(t){s("GHgd")},"data-v-33c069a4",null);e.default=n.exports}});
//# sourceMappingURL=53.a437eb077e1f56036a2a.js.map